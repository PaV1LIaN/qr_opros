<?php
if (!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED !== true) die();

global $USER;
if (!$USER->IsAdmin()):
?>
<div class="ui-alert ui-alert-warning">
    <span class="ui-alert-message">У вас нет прав для создания порталов.</span>
</div>
<?php return; endif; ?>

<div class="ui-card"
     style="padding:24px;border-radius:12px;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,0.08);max-width:960px;margin-bottom:32px;">
    <h3 style="margin-bottom:18px;font-size:20px;font-weight:600;">Создание нового портала</h3>

    <form method="post">
        <?= bitrix_sessid_post() ?>
        <input type="hidden" name="create_site" value="Y">

        <div class="ui-form-row">
            <div class="ui-form-label">Название сайта:</div>
            <div class="ui-form-content">
                <div class="ui-ctl ui-ctl-textbox">
                    <input type="text" name="site_title" class="ui-ctl-element"
                           placeholder="Например: Отдел продаж" required>
                </div>
            </div>
        </div>

        <div class="ui-form-row">
            <div class="ui-form-label">Код сайта (папка):</div>
            <div class="ui-form-content">
                <div class="ui-ctl ui-ctl-textbox">
                    <input type="text" name="site_code" class="ui-ctl-element"
                           placeholder="sales или hr" required>
                </div>
            </div>
        </div>

        <div class="ui-form-row">
            <div class="ui-form-label">Название роли:</div>
            <div class="ui-form-content">
                <div class="ui-ctl ui-ctl-textbox">
                    <input type="text" name="role_name" class="ui-ctl-element"
                           placeholder="Роль портала" required>
                </div>
            </div>
        </div>

        <!-- ===== Администраторы портала ===== -->
        <div class="ui-form-row">
            <div class="ui-form-label">Администраторы портала:</div>
            <div class="ui-form-content">
                <?php
                $APPLICATION->IncludeComponent(
                    'bitrix:main.user.selector',
                    '',
                    [
                        'INPUT_NAME'       => 'role_users',
                        'ID'               => 'portal_admin_selector',
                        'MULTIPLE'         => 'Y',
                        'USE_SYMBOLIC_ID'  => 'N',
                        'SHOW_BUTTON'      => 'Y',
                        'BUTTON_CAPTION'   => 'Выбрать администраторов',
                    ],
                    false,
                    ['HIDE_ICONS' => 'Y']
                );
                ?>
            </div>
        </div>

        <!-- ===== Обычные пользователи ===== -->
        <div class="ui-form-row">
            <div class="ui-form-label">Обычные пользователи:</div>
            <div class="ui-form-content">
                <?php
                $APPLICATION->IncludeComponent(
                    'bitrix:main.user.selector',
                    '',
                    [
                        'INPUT_NAME'       => 'site_users',
                        'ID'               => 'portal_user_selector',
                        'MULTIPLE'         => 'Y',
                        'USE_SYMBOLIC_ID'  => 'N',
                        'SHOW_BUTTON'      => 'Y',
                        'BUTTON_CAPTION'   => 'Выбрать пользователей',
                    ],
                    false,
                    ['HIDE_ICONS' => 'Y']
                );
                ?>
            </div>
        </div>

        <div class="ui-form-row" style="margin-top:24px;">
            <button type="submit" class="ui-btn ui-btn-success ui-btn-lg">Создать портал</button>
        </div>
    </form>
</div>
