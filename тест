<?php
use Bitrix\Main\ModuleManager;

class qr_machine extends CModule
{
    public $MODULE_ID = "qr.machine";
    public $MODULE_NAME = "QR-коды для опросов машин";
    public $MODULE_DESCRIPTION = "Генерация QR на OnAfterIBlockElementAdd/Update";
    public $PARTNER_NAME = "MyCompany";
    public $PARTNER_URI  = "https://example.com";

    public function DoInstall()
    {
        ModuleManager::registerModule($this->MODULE_ID);
        // Регистрируем события
        RegisterModuleDependences(
            "iblock", "OnAfterIBlockElementAdd",
            $this->MODULE_ID, "QrMachine\\EventHandlers", "onAfterIBlockElementModify"
        );
        RegisterModuleDependences(
            "iblock", "OnAfterIBlockElementUpdate",
            $this->MODULE_ID, "QrMachine\\EventHandlers", "onAfterIBlockElementModify"
        );
    }

    public function DoUninstall()
    {
        // Убираем обработчики
        UnRegisterModuleDependences(
            "iblock", "OnAfterIBlockElementAdd",
            $this->MODULE_ID, "QrMachine\\EventHandlers", "onAfterIBlockElementModify"
        );
        UnRegisterModuleDependences(
            "iblock", "OnAfterIBlockElementUpdate",
            $this->MODULE_ID, "QrMachine\\EventHandlers", "onAfterIBlockElementModify"
        );
        ModuleManager::unRegisterModule($this->MODULE_ID);
    }
}
