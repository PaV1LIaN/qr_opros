public static function createPortalSite($siteTitle, $siteCode, $roleName, $roleUsers = [])
{
    if (!\Bitrix\Main\Loader::includeModule("iblock")) {
        return ["success" => false, "message" => "–ú–æ–¥—É–ª—å –∏–Ω—Ñ–æ–±–ª–æ–∫–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω"];
    }

    $IBLOCK_ID = self::getPortalIblockId();
    if ($IBLOCK_ID <= 0) {
        return ["success" => false, "message" => "–ò–Ω—Ñ–æ–±–ª–æ–∫ 'portal_sites' –Ω–µ –Ω–∞–π–¥–µ–Ω"];
    }

    $siteTitle = trim($siteTitle);
    $siteCode  = trim($siteCode);

    if ($siteTitle === "" || $siteCode === "") {
        return ["success" => false, "message" => "–ù–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–æ–¥ —Å–∞–π—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã"];
    }

    // üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —Å–∞–π—Ç–∞ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º/–∫–æ–¥–æ–º
    $exists = \CIBlockElement::GetList(
        [],
        ["IBLOCK_ID" => $IBLOCK_ID, [
            "LOGIC" => "OR",
            ["NAME" => $siteTitle],
            ["CODE" => $siteCode],
        ]],
        false, false, ["ID", "NAME"]
    )->Fetch();

    if ($exists) {
        return ["success" => false, "status" => "exists", "message" => "–°–∞–π—Ç —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏–ª–∏ –∫–æ–¥–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"];
    }

    // üëë –°–æ–∑–¥–∞—ë–º 2 –≥—Ä—É–ø–ø—ã: –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
    $groupAdmin = new \CGroup;
    $roleAdminId = $groupAdmin->Add([
        "ACTIVE" => "Y",
        "C_SORT" => 100,
        "NAME" => $roleName . " (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)",
        "STRING_ID" => "portal_role_" . $siteCode
    ]);

    $groupUser = new \CGroup;
    $roleUserId = $groupUser->Add([
        "ACTIVE" => "Y",
        "C_SORT" => 200,
        "NAME" => $roleName . " (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)",
        "STRING_ID" => "portal_user_" . $siteCode
    ]);

    if (!$roleAdminId || !$roleUserId) {
        return ["success" => false, "message" => "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"];
    }

    // –î–æ–±–∞–≤–ª—è–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ –≥—Ä—É–ø–ø—É
    foreach ($roleUsers as $uid) {
        $uid = (int)$uid;
        if ($uid > 0) {
            $groups = (array)\CUser::GetUserGroup($uid);
            if (!in_array($roleAdminId, $groups, true)) {
                $groups[] = $roleAdminId;
                \CUser::SetUserGroup($uid, $groups);
            }
        }
    }

    // üóÇÔ∏è –î–æ–±–∞–≤–ª—è–µ–º —Å–∞–π—Ç –≤ –∏–Ω—Ñ–æ–±–ª–æ–∫
    $el = new \CIBlockElement;
    $id = $el->Add([
        "IBLOCK_ID" => $IBLOCK_ID,
        "NAME" => $siteTitle,
        "CODE" => $siteCode,
        "ACTIVE" => "Y",
        "PROPERTY_VALUES" => [
            "SITE_ROLE" => $roleAdminId,
            "SITE_USER_ROLE" => $roleUserId,
        ],
    ]);

    if (!$id) {
        return ["success" => false, "message" => "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–∞–π—Ç–∞: " . $el->LAST_ERROR];
    }

    return ["success" => true, "id" => $id];
}
