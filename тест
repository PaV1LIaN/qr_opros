<?php
if (!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED !== true) die();

use Bitrix\Main\Loader;

if (!Loader::includeModule('main')) { return; }

// ВАЖНО: путь к классу остаётся внутри проекта
require_once $_SERVER['DOCUMENT_ROOT'].'/local/siteforge/lib/SiteFactory.php';

global $USER;
if (!$USER->IsAuthorized()) {
    echo '<div class="ui-alert ui-alert-warning" style="margin:16px 0">Пожалуйста, авторизуйтесь, чтобы видеть доступные сайты.</div>';
    return;
}

$factory = new \Local\Siteforge\SiteFactory();

// ...дальше — ровно тот же код рендера сетки сайтов (listSites(), userHasAccessToSite() и т.п.)
