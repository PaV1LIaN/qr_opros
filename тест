public static function createPortalSite($siteTitle, $siteCode, $roleName, $roleUsers = [])
{
    if (!\Bitrix\Main\Loader::includeModule("iblock")) {
        return ["success" => false, "message" => "–ú–æ–¥—É–ª—å –∏–Ω—Ñ–æ–±–ª–æ–∫–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω"];
    }

    $IBLOCK_ID = self::getPortalIblockId();
    if ($IBLOCK_ID <= 0) {
        return ["success" => false, "message" => "–ò–Ω—Ñ–æ–±–ª–æ–∫ 'portal_sites' –Ω–µ –Ω–∞–π–¥–µ–Ω"];
    }

    $siteTitle = trim($siteTitle);
    $siteCode  = trim($siteCode);

    if ($siteTitle === "" || $siteCode === "") {
        return ["success" => false, "message" => "–ù–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–æ–¥ —Å–∞–π—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã"];
    }

    // üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–∞–π—Ç–∞
    $exists = \CIBlockElement::GetList(
        [],
        [
            "IBLOCK_ID" => $IBLOCK_ID,
            [
                "LOGIC" => "OR",
                ["NAME" => $siteTitle],
                ["CODE" => $siteCode],
            ]
        ],
        false,
        false,
        ["ID", "NAME", "CODE"]
    )->Fetch();

    if ($exists) {
        return [
            "success" => false,
            "status" => "exists",
            "message" => "–°–∞–π—Ç —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏–ª–∏ –∫–æ–¥–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
        ];
    }

    // üß± –°–æ–∑–¥–∞—ë–º –≥—Ä—É–ø–ø—É (—Ä–æ–ª—å)
    $group = new CGroup;
    $roleId = $group->Add([
        "ACTIVE" => "Y",
        "C_SORT" => 100,
        "NAME" => $roleName,
        "STRING_ID" => "portal_role_" . $siteCode
    ]);

    if (!$roleId) {
        return ["success" => false, "message" => "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É —Ä–æ–ª–∏"];
    }

    // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ä–æ–ª—å
    foreach ($roleUsers as $uid) {
        $uid = (int)$uid;
        if ($uid > 0) {
            $groups = CUser::GetUserGroup($uid);
            if (!in_array($roleId, $groups, true)) {
                $groups[] = $roleId;
                CUser::SetUserGroup($uid, $groups);
            }
        }
    }

    // üóÇÔ∏è –°–æ–∑–¥–∞—ë–º —ç–ª–µ–º–µ–Ω—Ç –∏–Ω—Ñ–æ–±–ª–æ–∫–∞
    $el = new CIBlockElement;
    $id = $el->Add([
        "IBLOCK_ID" => $IBLOCK_ID,
        "NAME" => $siteTitle,
        "CODE" => $siteCode,
        "ACTIVE" => "Y",
        "PROPERTY_VALUES" => [
            "SITE_ROLE" => $roleId
        ],
    ]);

    if (!$id) {
        return ["success" => false, "message" => "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–∞–π—Ç–∞: " . $el->LAST_ERROR];
    }

    // –í—Å—ë —É—Å–ø–µ—à–Ω–æ
    return ["success" => true, "id" => $id, "message" => "–°–∞–π—Ç —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ"];
}
