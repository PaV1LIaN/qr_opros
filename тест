public function assertSiteCodeUnique(string $code, int $excludeSiteId = 0): void
{
    $sitesClass = $this->sitesClass;

    $filter = ['=UF_CODE' => $code];

    if ($excludeSiteId > 0) {
        $filter['!ID'] = $excludeSiteId;
    }

    $row = $sitesClass::getList([
        'filter' => $filter,
        'select' => ['ID'],
        'limit' => 1,
    ])->fetch();

    if ($row) {
        throw new \InvalidArgumentException('CODE уже используется. Выбери другой.');
    }
}
